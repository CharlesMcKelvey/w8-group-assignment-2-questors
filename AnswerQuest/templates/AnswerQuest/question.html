{% extends 'AnswerQuest/base.html' %}
{% load static %}
{% load markdownify %}

<!-- 
Assumptions made towards the question:
    
Grabbing the Question data:
    title, 
    body, 
    author, 
    answers, 
    favorited/starred amount, 
    
-->

{% block content %}

<link rel="stylesheet" href="{% static 'question_stylesheet.css' %}
    <div class="question-container">
        <div class="question-text-container">
            {% if question.is_solved %}SOLVED{% endif %}
            {% if request.user == author %}
                <a href="{}">Edit Question</a>
            {% endif %}
            <p class="question-title">{{ question.title }}</p>
            <p class="question-body">{{ question.body|markdownify }}</p>
            <!-- Add author profile link. Something we didn't discuss but seems good to have. Probably easy to implement as we are creating user accounts so might as well have -->
            <a class="question-author">{{ question.author }}</a>
        </div>
        <button id="add-answer">Add Answer</button>
        <form id="answer-form" action="" method="POST">
            {% csrf_token %}
            <input type="text">
            <button type="submit">Submit</button>
        </form>
        {% if question.answers.count %}
        {% for answer in question.answers.all %}
        
        <div class="answer-container">
            <div class="answer-text-container">
                <p>{{ answer.body }}</p>
                <p>{{ answer.author }}</p>
            </div>
            <div class="vote-container">
                <p class="upvote">Upvote {{answer.upvotes}}</p>
                <!-- This will be where the Upvote icon goes -->
                <p class="downvote">Downvote {{answer.downvotes}}</p>
                <!-- This will be where the Downvote icon goes -->
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="answer-container">
            <h2>There are no answers for this question</h2>
        </div>
        {% endif %}

        <!-- Form will go here -->
        <form action='' method='POST'>
            {% csrf_token %}
            {{ form }}
            <!-- <input type='text' value='{{ answer.body }}'> -->
            <button type='submit'>Propose Answer</button>
        </form>

        <!-- Something I noticed is that we need to add the ability to see multiple answers to the same question. 
             Currently only displaying one 
            This impeded me from being able to do the answer form for the page but I think I know how to do it  -->
            <script>
            add_answer = document.querySelector('#add-answer')
            add_answer.addEventListener('click', event => {
                event.preventDefault()
                add_answer.style.display = 'none';
                document.getElementById('answer-form').style.display = 'block';
            })
            </script>
    </div>
{% endblock %}